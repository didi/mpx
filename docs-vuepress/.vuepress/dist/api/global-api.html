<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>全局 API | Mpx框架</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/favicon.ico">
    <script type="text/javascript">(function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "jtvvy52wxy");</script>
    <meta name="description" content="Mpxjs 是滴滴开源的支持跨端开发、深度性能优化的增强型小程序开发框架。使用 Mpxjs 帮助你更好开发小程序，拥有类似 VueJS 的数据响应能力，在降低研发心智负担的同时比原生小程序性能更好，完全基于原生小程序语法保障了最少的坑，一次开发多端生效同时支持微信小程序、支付宝小程序、抖音小程序、百度小程序、Web H5。">
    
    <link rel="preload" href="/assets/css/0.styles.f22478ca.css" as="style"><link rel="preload" href="/assets/js/app.84c88b57.js" as="script"><link rel="preload" href="/assets/js/7.01e4e942.js" as="script"><link rel="preload" href="/assets/js/3.145e69cd.js" as="script"><link rel="preload" href="/assets/js/1.4f7abe8f.js" as="script"><link rel="preload" href="/assets/js/42.53972f6c.js" as="script"><link rel="preload" href="/assets/js/30.04d1a7ea.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.f22478ca.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><div class="content-wrapper"><div class="container"><div class="theme-container"><header class="header" data-v-3ad594c3><!----> <div class="head-container" data-v-3ad594c3><a href="/" data-v-3ad594c3><div class="logo" data-v-3ad594c3>mpx</div></a> <div class="row" data-v-3ad594c3><div class="header__line" data-v-3ad594c3></div> <nav class="nav" data-v-3ad594c3><a href="/guide/basic/start.html" class="nav-link" data-v-3ad594c3>
          指南
          <!----></a></nav><nav class="nav" data-v-3ad594c3><a href="/api/" class="nav-link" data-v-3ad594c3>
          API
          <!----></a></nav><nav class="nav" data-v-3ad594c3><a href="/articles/" class="nav-link" data-v-3ad594c3>
          文章
          <!----></a></nav><nav class="nav" data-v-3ad594c3><a href="https://github.com/didi/mpx/releases" target="_blank" class="nav-link" data-v-3ad594c3>
          更新记录
          <!----></a></nav><nav class="nav" data-v-3ad594c3><a href="https://github.com/didi/mpx" target="_blank" class="nav-link" data-v-3ad594c3>
          GitHub
          <!----></a></nav> <div class="searchBox-wrapper" data-v-3ad594c3><div class="searchBox" data-v-3ad594c3><form id="search-form" role="search" class="algolia-search-wrapper search-box" data-v-3ad594c3><div id="docsearch-container"></div></form></div></div></div></div> <!----></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/basic/start.html" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="/api/index.html" class="nav-link">
  API
</a></div><div class="nav-item"><a href="/articles/index.html" class="nav-link">
  文章
</a></div><div class="nav-item"><a href="https://github.com/didi/mpx/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  更新记录
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/didi/mpx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/api/app-config.html" class="sidebar-link">全局配置</a></li><li><a href="/api/global-api.html" aria-current="page" class="active sidebar-link">全局 API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/global-api.html#global-mpx" class="sidebar-link">全局对象 Mpx</a></li><li class="sidebar-sub-header"><a href="/api/global-api.html#createapp" class="sidebar-link">createApp</a></li><li class="sidebar-sub-header"><a href="/api/global-api.html#createpage" class="sidebar-link">createPage</a></li><li class="sidebar-sub-header"><a href="/api/global-api.html#createcomponent" class="sidebar-link">createComponent</a></li><li class="sidebar-sub-header"><a href="/api/global-api.html#nexttick" class="sidebar-link">nextTick</a></li><li class="sidebar-sub-header"><a href="/api/global-api.html#topureobject" class="sidebar-link">toPureObject</a></li><li class="sidebar-sub-header"><a href="/api/global-api.html#getmixin" class="sidebar-link">getMixin</a></li><li class="sidebar-sub-header"><a href="/api/global-api.html#implement" class="sidebar-link">implement</a></li><li class="sidebar-sub-header"><a href="/api/global-api.html#built-in-lifecycle-variable" class="sidebar-link">内建生命周期变量</a></li><li class="sidebar-sub-header"><a href="/api/global-api.html#响应式-api" class="sidebar-link">响应式 API</a></li><li class="sidebar-sub-header"><a href="/api/global-api.html#组合式-api" class="sidebar-link">组合式 API</a></li><li class="sidebar-sub-header"><a href="/api/global-api.html#store-api" class="sidebar-link">store API</a></li></ul></li><li><a href="/api/instance-api.html" class="sidebar-link">实例 API</a></li><li><a href="/api/store-api.html" class="sidebar-link">Store API</a></li><li><a href="/api/directives.html" class="sidebar-link">模板指令</a></li><li><a href="/api/compile.html" class="sidebar-link">编译构建</a></li><li><a href="/api/builtIn.html" class="sidebar-link">内建组件</a></li><li><a href="/api/reactivity-api.html" class="sidebar-link">响应式 API</a></li><li><a href="/api/composition-api.html" class="sidebar-link">组合式 API</a></li><li><a href="/api/optional-api.html" class="sidebar-link">选项式 API</a></li><li><a href="/api/extend.html" class="sidebar-link">周边拓展</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="全局-api"><a href="#全局-api" class="header-anchor">#</a> 全局 API</h1> <h2 id="global-mpx"><a href="#global-mpx" class="header-anchor">#</a> 全局对象 Mpx </h2> <p><code>@mpxjs/core</code> 默认导出 mpx 全局实例对象，通过该实例对象我们可以访问部分应用实例 API</p> <h3 id="mixin"><a href="#mixin" class="header-anchor">#</a> mixin</h3> <p>全局注入mixin方法接收两个参数：mpx.mixin(mixins, options)</p> <ul><li>第一个参数是要混入的mixins，接收类型 <code>MixinObject|MixinObject[]</code></li> <li>第二个参数是为全局混入配置，形如<code>{types:string|string[], stage:number}</code>，其中<code>types</code>用于控制mixin注入的范围，可选值有<code>'app'|'page'|'component'</code>；<code>stage</code>用于控制注入mixin的插入顺序，当stage为负数时，注入的mixin会被插入到构造函数配置中的<code>options.mixins</code>之前，数值越小约靠前，反之当stage为正数时，注入的mixin会被插入到<code>options.mixins</code>之后，数值越大越靠后。</li></ul> <blockquote><p>所有mixin中生命周期的执行均先于构造函数配置中直接声明的生命周期，mixin之间的执行顺序则遵从于其在<code>options.mixins</code>数组中的顺序</p></blockquote> <blockquote><p>options的默认值为<code>{types: ['app','page','component'], stage: -1}</code>，不传stage时，全局注入mixin的声明周期默认在<code>options.mixins</code>之前执行</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> mpx <span class="token keyword">from</span> <span class="token string">'@mpxjs/core'</span>
<span class="token comment">// 只在page中混入</span>
mpx<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">getData</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">types</span><span class="token operator">:</span><span class="token string">'page'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 默认混入，在app|page|component中都会混入</span>
mpx<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">getData</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">setData</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">// 只在component中混入，且执行顺序在options.mixins之后</span>
mpx<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">attached</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'com attached'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">types</span><span class="token operator">:</span> <span class="token string">'component'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">stage</span><span class="token operator">:</span> <span class="token number">100</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="injectmixins"><a href="#injectmixins" class="header-anchor">#</a> injectMixins</h3> <p>该方法是 <code>mpx.mixin</code> 方法的别名，<code>mpx.injectMixins({})</code> 等同于 <code>mpx.mixin({})</code></p> <h3 id="observable"><a href="#observable" class="header-anchor">#</a> observable</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">observable</span><span class="token punctuation">(</span>options<span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> Mpx
</code></pre></div><p>用于创建响应式数据。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> mpx <span class="token keyword">from</span> <span class="token string">'@mpxjs/core'</span>
<span class="token comment">// 直接通过 mpx 对象访问</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> mpx<span class="token punctuation">.</span><span class="token function">observable</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>注意：</strong>
Mpx 2.8 版本后该 API 等同于 <code>reactive</code>，同时不再支持具名导出方式，建议直接使用 <code>reactive</code> 替代，请<a href="/api/reactivity-api/basic-reactivity.html#reactive">点击</a>查看。</li></ul> <h3 id="set"><a href="#set" class="header-anchor">#</a> set</h3> <p>用于对一个响应式对象新增属性，会<code>触发订阅者更新操作</code>。<a href="/api/global-api.html#set">查看详情</a></p> <h3 id="delete"><a href="#delete" class="header-anchor">#</a> delete</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token keyword">delete</span><span class="token punctuation">(</span>target<span class="token operator">:</span> Object<span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><p>用于对一个响应式对象删除属性，会<code>触发订阅者更新操作</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> mpx<span class="token punctuation">,</span> <span class="token punctuation">{</span> reactive <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@mpxjs/core'</span>
<span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
mpx<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>注意：</strong> <code>mpx.delete</code> 也可以使用具名导出的 <code>del</code>。<a href="/api/global-api.html#del">查看详情</a></li></ul> <h3 id="use"><a href="#use" class="header-anchor">#</a> use</h3> <blockquote><p>用于安装外部扩展, 支持多参数
方法接收两个参数：mpx.use(plugin, options)</p></blockquote> <ul><li>第一个参数是要安装的外部扩展</li> <li>第二个参数是对象，如果第二个参数是一个包含（prefix or postfix）的option， 那么将会对插件扩展的属性添加前缀或后缀</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> mpx <span class="token keyword">from</span> <span class="token string">'@mpxjs/core'</span>
<span class="token keyword">import</span> test <span class="token keyword">from</span> <span class="token string">'./test'</span>
mpx<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span>
mpx<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>test<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">prefix</span><span class="token operator">:</span> <span class="token string">'mpx'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'otherparams'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="watch"><a href="#watch" class="header-anchor">#</a> watch</h3> <p>watch 可以通过全局实例访问，也可以使用具名导出的方式，二者逻辑相同，我们推荐使用具名导出的方式。<a href="/api/reactivity-api/computed-watch-api.html#watch">查看详情</a></p> <h2 id="createapp"><a href="#createapp" class="header-anchor">#</a> createApp</h2> <blockquote><p>注册一个小程序，接受一个 Object 类型的参数</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>createApp<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@mpxjs/core'</span>

<span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">onLaunch</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Launch'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onShow</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Page show'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">//全局变量 可通过getApp()访问</span>
  <span class="token literal-property property">globalDataA</span><span class="token operator">:</span> <span class="token string">'I am global dataA'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">globalDataB</span><span class="token operator">:</span> <span class="token string">'I am global dataB'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 或者</span>
<span class="token function">createApp</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
</code></pre></div><h2 id="createpage"><a href="#createpage" class="header-anchor">#</a> createPage</h2> <blockquote><p>类微信小程序（微信、百度、头条等）内部使用<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/component.html" target="_blank" rel="noopener noreferrer">Component的方式创建页面<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，所以除了支持页面的生命周期之外还同时支持组件的一切特性。当使用 Component 创建页面时，页面生命周期需要写在 methods 内部（微信小程序原生规则），mpx 进行了统一封装转换，页面生命周期都写在最外层即可</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">createPage</span><span class="token punctuation">(</span>options<span class="token operator">:</span> object<span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><ul><li><p>options:</p> <p>具体形式除了 computed、watch 这类 Mpx 扩展特性之外，其他的属性都参照原生小程序的官方文档即可。</p></li> <li><p>config:</p> <p>如果希望标识一个组件是最纯粹的原生组件，不用数据响应等能力，可通过 config.isNative 传 true 声明。
如果有需要复写/改写最终调用的创建页面的构造器，可以通过 config 对象的 customCtor 提供。</p> <ul><li><strong>注意:</strong>
mpx本身是用 component 来创建页面的，如果传page可能在初始化时候生命周期不正常导致取props有一点问题</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>createPage<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@mpxjs/core'</span>

<span class="token function">createPage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">test2</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>test <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">test</span> <span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> old</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> old<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onShow</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>test<span class="token operator">++</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="createcomponent"><a href="#createcomponent" class="header-anchor">#</a> createComponent</h2> <blockquote><p>创建自定义组件，接受两个Object类型的参数。</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">createComponent</span><span class="token punctuation">(</span>options<span class="token operator">:</span> object<span class="token punctuation">,</span> config<span class="token operator">?</span><span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>createComponent<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@mpxjs/core'</span>

<span class="token function">createComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">properties</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">prop</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span>
      <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">10</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">test2</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>test <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prop
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">test</span> <span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> old</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> old<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">prop</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">handler</span> <span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> old</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> old<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">immediate</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 是否首次执行一次</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="nexttick"><a href="#nexttick" class="header-anchor">#</a> nextTick</h2> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">nextTick</span><span class="token punctuation">(</span>callback<span class="token operator">:</span> <span class="token builtin">Function</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><p>当我们在 Mpx 中更改响应性状态时，最终页面的更新并不是同步立即生效的，而是由 Mpx 将它们缓存在一个队列中， 等到下一个 tick 一起执行，
从而保证了组件/页面无论发生多少状态改变，都仅执行一次更新，从而减少 <code>setData</code> 调用次数。</p> <p><code>nextTick()</code> 可以在状态改变后立即调用，可以传递一个函数作为参数，在等待页面/组件更新完成后，函数参数会触发执行。</p> <div class="language-js extra-class"><pre class="language-js"><code>     <span class="token keyword">import</span> <span class="token punctuation">{</span>createComponent<span class="token punctuation">,</span> nextTick<span class="token punctuation">,</span> ref<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@mpxjs/core'</span>
     <span class="token function">createComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
       <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">const</span> showChild <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
         <span class="token comment">// DOM 还没有更新</span>
         <span class="token function">setTimeOut</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            showChild<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
         <span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           context<span class="token punctuation">.</span>refs<span class="token punctuation">[</span><span class="token string">'child'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span> <span class="token punctuation">{</span>
           showChild
         <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="topureobject"><a href="#topureobject" class="header-anchor">#</a> toPureObject</h2> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">toPureObject</span><span class="token punctuation">(</span>options<span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> object
</code></pre></div><p>业务拿到的数据可能是响应式数据实例（包含了些其他属性），使用<code>toPureObject</code>方法可以将响应式的数据转化成纯 js 对象。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>toPureObject<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@mpxjs/core'</span>
<span class="token keyword">const</span> pureObject <span class="token operator">=</span> <span class="token function">toPureObject</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>
</code></pre></div><h2 id="getmixin"><a href="#getmixin" class="header-anchor">#</a> getMixin</h2> <p>专为ts项目提供的反向推导辅助方法，该函数接收类型为 <code>Object</code> ,会将传入的嵌套mixins对象拉平成一个扁平的mixin对象</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createComponent<span class="token punctuation">,</span> getMixin<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@mpxjs/core'</span>
<span class="token comment">// 使用mixins，需要对每一个mixin子项进行getMixin辅助函数包裹，支持嵌套mixin</span>
<span class="token keyword">const</span> mixin <span class="token operator">=</span> <span class="token function">getMixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">mixins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">getMixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">value1</span><span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">lifetimes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">attached</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value1<span class="token punctuation">,</span> <span class="token string">'attached'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">mixins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">getMixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">value2</span><span class="token operator">:</span> <span class="token number">6</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value1 <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value2 <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>outsideVal<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">/*
mixin值
{
  data: {value2: 6, value1: 2},
  created: ƒ created(),
  attached: ƒ attached()
}
*/</span>
<span class="token function">createComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">outsideVal</span><span class="token operator">:</span> <span class="token number">20</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mixins</span><span class="token operator">:</span> <span class="token punctuation">[</span>mixin<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">/*
以上执行输出：
28
2 &quot;attached&quot;
*/</span>
</code></pre></div><h2 id="implement"><a href="#implement" class="header-anchor">#</a> implement</h2> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">implement</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> options<span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> object
</code></pre></div><ul><li><code>{Object} options</code> <ul><li><code>{Array} modes</code>：需要取消的平台</li> <li><code>{Boolean} remove</code>：是否将此能力直接移除</li> <li><code>{Function} processor</code>：设置成功的回调函数</li></ul></li></ul> <p>以微信为 base 将代码转换输出到其他平台时（如支付宝、web 平台等），会存在一些无法进行模拟的跨平台差异，会在运行时进行检测并报错指出，例如微信转支付宝时使用 moved 生命周期等。使用<code>implement</code>方法可以取消这种报错。您可以使用 mixin 自行实现跨平台差异，然后使用 implement 取消报错。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>implement<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@mpxjs/core'</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>__mpx_mode__ <span class="token operator">===</span> <span class="token string">'web'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">processor</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
  <span class="token function">implement</span><span class="token punctuation">(</span><span class="token string">'onShareAppMessage'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">modes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'web'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 需要取消的平台，可配置多个</span>
    <span class="token literal-property property">remove</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否将此能力直接移除</span>
    processor <span class="token comment">// 设置成功的回调函数</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="built-in-lifecycle-variable"><a href="#built-in-lifecycle-variable" class="header-anchor">#</a> 内建生命周期变量 </h2> <p>Mpx 在运行时自身有着一套内建生命周期，当开发者想使用内建生命周期时，可以通过内建生命周期变量进行对应生命周期的注册，
需要注意的是，这部分内建生命周期变量<strong>只能用于选项式 API 中</strong>。</p> <h3 id="beforecreate"><a href="#beforecreate" class="header-anchor">#</a> BEFORECREATE</h3> <p><code>string</code></p> <p>在组件实例刚刚被创建时执行，在实例初始化之后、进行数据侦听和 data 初始化之前同步调用，注意此时不能调用 setData。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>createComponent<span class="token punctuation">,</span> <span class="token constant">BEFORECREATE</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@mpxjs/core&quot;</span>

<span class="token function">createComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">BEFORECREATE</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'beforecreate trigger'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="created"><a href="#created" class="header-anchor">#</a> CREATED</h3> <p><code>string</code></p> <p>在组件实例刚刚被创建时执行。在这一步中，实例已完成对选项的处理，意味着以下内容已被配置完毕：数据侦听、计算属性、事件/侦听器的回调函数。
然而，挂载阶段还没开始，注意此时不能调用 setData。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>createComponent<span class="token punctuation">,</span> <span class="token constant">CREATED</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@mpxjs/core&quot;</span>

<span class="token function">createComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">CREATED</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'beforecreate trigger'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="beforemount"><a href="#beforemount" class="header-anchor">#</a> BEFOREMOUNT</h3> <p>选项式 API 中使用，作用同<a href="/api/composition-api.html#onbeforemount">onBeforeMount</a></p> <h3 id="mounted"><a href="#mounted" class="header-anchor">#</a> MOUNTED</h3> <p>选项式 API 中使用，作用同<a href="/api/composition-api.html#onmounted">onMounted</a></p> <h3 id="beforeupdate"><a href="#beforeupdate" class="header-anchor">#</a> BEFOREUPDATE</h3> <p>选项式 API 中使用，作用同<a href="/api/composition-api.html#onbeforeupdate">onBeforeUpdate</a></p> <h3 id="updated"><a href="#updated" class="header-anchor">#</a> UPDATED</h3> <p>选项式 API 中使用，作用同<a href="/api/composition-api.html#onupdated">onUpdated</a></p> <h3 id="serverprefetch"><a href="#serverprefetch" class="header-anchor">#</a> SERVERPREFETCH</h3> <p>选项式 API 中使用，作用同<a href="/api/composition-api.html#onServerPrefetch">onServerPrefetch</a></p> <h3 id="beforeunmount"><a href="#beforeunmount" class="header-anchor">#</a> BEFOREUNMOUNT</h3> <p>选项式 API 中使用，作用同<a href="/api/composition-api.html#onbeforeunmount">onBeforeUnmount</a></p> <h3 id="unmounted"><a href="#unmounted" class="header-anchor">#</a> UNMOUNTED</h3> <p>选项式 API 中使用，作用同<a href="/api/composition-api.html#onunmounted">onUnmounted</a></p> <h3 id="onload"><a href="#onload" class="header-anchor">#</a> ONLOAD</h3> <p>选项式 API 中使用，作用同<a href="/api/composition-api.html#onload">onLoad</a></p> <h3 id="onshow"><a href="#onshow" class="header-anchor">#</a> ONSHOW</h3> <p>选项式 API 中使用，作用同<a href="/api/composition-api.html#onshow">onShow</a></p> <h3 id="onhide"><a href="#onhide" class="header-anchor">#</a> ONHIDE</h3> <p>选项式 API 中使用，作用同<a href="/api/composition-api.html#onhide">onHide</a></p> <h3 id="onresize"><a href="#onresize" class="header-anchor">#</a> ONRESIZE</h3> <p>选项式 API 中使用，作用同<a href="/api/composition-api.html#onresize">onResize</a></p> <h2 id="响应式-api"><a href="#响应式-api" class="header-anchor">#</a> 响应式 API</h2> <p>详情请<a href="/api/reactivity-api/basic-reactivity.html">移步</a></p> <h2 id="组合式-api"><a href="#组合式-api" class="header-anchor">#</a> 组合式 API</h2> <p>详情请<a href="/api/composition-api.html">移步</a></p> <h2 id="store-api"><a href="#store-api" class="header-anchor">#</a> store API</h2> <p>详情请<a href="/api/store-api.html">移步</a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/api/app-config.html" class="prev">
        全局配置
      </a></span> <span class="next"><a href="/api/instance-api.html">
        实例 API
      </a>
      →
    </span></p></div> </main></div></div></div></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.84c88b57.js" defer></script><script src="/assets/js/7.01e4e942.js" defer></script><script src="/assets/js/3.145e69cd.js" defer></script><script src="/assets/js/1.4f7abe8f.js" defer></script><script src="/assets/js/42.53972f6c.js" defer></script><script src="/assets/js/30.04d1a7ea.js" defer></script>
  </body>
</html>
